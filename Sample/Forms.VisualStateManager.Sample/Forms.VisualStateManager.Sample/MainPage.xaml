<ContentPage
    x:Class="Forms.VisualStateManager.Sample.MainPage"
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:animations="clr-namespace:Forms.VisualStateManager.Animations;assembly=Forms.VisualStateManager"
    xmlns:visualStateManager="clr-namespace:Forms.VisualStateManager;assembly=Forms.VisualStateManager"
    x:Name="Root">
    <ContentPage.Resources>
        <ResourceDictionary>
            <Style x:Key="Frame" TargetType="Frame">
                <Setter Property="WidthRequest" Value="64" />
                <Setter Property="HeightRequest" Value="64" />
                <Setter Property="CornerRadius" Value="0" />
                <Setter Property="visualStateManager:VisualStateManager.VisualStateGroups">
                    <Setter.Value>
                        <visualStateManager:VisualStateGroupCollection>
                            <visualStateManager:VisualStateGroup Name="a">
                                <visualStateManager:VisualStateGroup.States>
                                    <visualStateManager:VisualState Name="a1">
                                        <visualStateManager:Storyboard>
                                            <animations:FloatAnimation
                                                AutoReverse="True"
                                                Easing="{x:Static Easing.CubicInOut}"
                                                RepeatBehavior="Forever"
                                                TargetProperty="Frame.CornerRadius"
                                                To="48"
                                                Duration="0:0:2" />
                                            <animations:DoubleAnimation
                                                AutoReverse="True"
                                                RepeatBehavior="Forever"
                                                TargetProperty="Frame.Opacity"
                                                From="1"
                                                To="0"
                                                Duration="0:0:2" />
                                        </visualStateManager:Storyboard>
                                    </visualStateManager:VisualState>
                                    <visualStateManager:VisualState Name="a2">
                                        <visualStateManager:Storyboard Easing="{x:Static Easing.CubicInOut}" Duration="Automatic">
                                            <animations:DoubleAnimation
                                                TargetProperty="Frame.Opacity"
                                                To="1"
                                                Duration="0:0:0.25" />
                                            <animations:FloatAnimation
                                                TargetProperty="Frame.CornerRadius"
                                                To="36"
                                                Duration="0:0:0.25" />
                                        </visualStateManager:Storyboard>
                                    </visualStateManager:VisualState>
                                </visualStateManager:VisualStateGroup.States>
                            </visualStateManager:VisualStateGroup>
                        </visualStateManager:VisualStateGroupCollection>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>
    <StackLayout Orientation="Vertical" VerticalOptions="Center">
        <StackLayout
            HorizontalOptions="Center"
            Orientation="Horizontal"
            VerticalOptions="Center">
            <Frame
                x:Name="Frame1"
                BackgroundColor="DarkOrange"
                Style="{StaticResource Frame}" />
            <Frame
                x:Name="Frame2"
                Margin="16,0"
                BackgroundColor="DodgerBlue"
                Style="{StaticResource Frame}" />
            <Frame
                x:Name="Frame3"
                BackgroundColor="CadetBlue"
                Style="{StaticResource Frame}" />
        </StackLayout>

        <Button
            Margin="0,20,0,0"
            Clicked="OnStateSwitchButtonClicked"
            HorizontalOptions="Center"
            Text="Switch state"
            WidthRequest="180" />

        <Button
            Margin="0,20,0,0"
            Clicked="OnStateSwitchButtonClicked2"
            HorizontalOptions="Center"
            Text="Switch state"
            WidthRequest="180" />
    </StackLayout>
</ContentPage>